# Apache Guacamole Setup Guide

Apache Guacamole is now running as part of your HomeLab stack! This gives you browser-based remote desktop access to machines on your network.

## üåê Access

**Web Interface**: http://localhost:8080/guacamole/

## üîê Default Credentials

- **Username**: `guacadmin`
- **Password**: `guacadmin`

‚ö†Ô∏è **IMPORTANT**: Change the default password immediately after first login!

## üöÄ First-Time Setup

1. **Login**: Navigate to http://localhost:8080/guacamole/ and login with default credentials

2. **Change Admin Password**:
   - Click your username (top right) ‚Üí Settings
   - Go to "Preferences" tab
   - Set a new strong password
   - Click "Update Password"

3. **Create New Admin User** (recommended):
   - Settings ‚Üí Users ‚Üí New User
   - Create a new admin account with a strong password
   - Grant "Administer system" permission
   - Logout and login with new account
   - Delete or disable the default `guacadmin` account

## üì° Adding Remote Connections

### RDP Connection (Windows)

1. Settings ‚Üí Connections ‚Üí New Connection
2. Edit Connection:
   - **Name**: `My Windows PC`
   - **Protocol**: `RDP`
   - **Network** section:
     - **Hostname**: IP address of Windows machine (e.g., `192.168.1.100`)
     - **Port**: `3389` (default)
   - **Authentication**:
     - **Username**: Windows username
     - **Password**: Windows password
     - **Domain**: (if applicable)
   - **Display**:
     - Resolution: `1920x1080` or auto-fit
     - Color depth: `True color (32-bit)`
3. Save

### VNC Connection (Linux/Mac)

1. Settings ‚Üí Connections ‚Üí New Connection
2. Edit Connection:
   - **Name**: `My Linux Server`
   - **Protocol**: `VNC`
   - **Network**:
     - **Hostname**: IP address (e.g., `192.168.1.101`)
     - **Port**: `5900` (default)
   - **Authentication**:
     - **Password**: VNC password
3. Save

### SSH Connection

1. Settings ‚Üí Connections ‚Üí New Connection
2. Edit Connection:
   - **Name**: `My SSH Server`
   - **Protocol**: `SSH`
   - **Network**:
     - **Hostname**: IP address (e.g., `192.168.1.102`)
     - **Port**: `22` (default)
   - **Authentication**:
     - **Username**: SSH username
     - **Password**: SSH password (or use private key)
3. Save

## üîß Configuration

### Environment Variables

Guacamole settings in `.env`:
```bash
GUACAMOLE_DB_USER=guacamole
GUACAMOLE_DB_PASSWORD=<auto-generated>
```

### Docker Containers

- **guacd**: Backend proxy daemon (port 4822)
- **guacamole-db**: PostgreSQL database for connection configs
- **guacamole**: Web application (port 8080)

### Data Persistence

- Database: `config/guacamole/postgres/`
- Init scripts: `config/guacamole/init/`

## üåê Remote Access via Cloudflare

Since you already have Cloudflare Tunnel configured, you can add Guacamole to your tunnel:

1. Go to Cloudflare Zero Trust Dashboard
2. Add a new public hostname:
   - **Subdomain**: `remote` (or your choice)
   - **Domain**: `joeparachini.com`
   - **Service**: `http://guacamole:8080`
   - **Path**: `/guacamole`

Then access from anywhere: `https://remote.joeparachini.com/guacamole`

## üõ°Ô∏è Security Recommendations

1. **Change default password immediately**
2. **Disable/delete default admin account** after creating new one
3. **Use strong passwords** for all accounts
4. **Enable two-factor authentication** (via TOTP extension if needed)
5. **Use Cloudflare Access** to add authentication layer before Guacamole
6. **Restrict access** to specific IPs if possible
7. **Enable connection recording** for audit trails (optional)

## üêõ Troubleshooting

### Can't connect to a machine

1. Verify the target machine is on and reachable:
   ```bash
   docker exec guacamole ping <target-ip>
   ```

2. Check if service is running on target:
   - RDP: Port 3389 open on Windows
   - VNC: VNC server running (e.g., TightVNC, RealVNC)
   - SSH: SSH server running

3. Check firewall rules on target machine

### View logs

```bash
# Guacamole web app logs
docker logs guacamole

# Guacd proxy logs
docker logs guacd

# Database logs
docker logs guacamole-db
```

### Restart services

```bash
cd ~/Parachini-HomeLab
docker-compose restart guacamole guacd guacamole-db
```

## üìö Additional Features

- **File Transfer**: Drag & drop files in RDP/SSH connections
- **Copy/Paste**: Text clipboard between local and remote
- **Recording**: Enable session recording for compliance
- **Connection Groups**: Organize connections by category
- **User Permissions**: Grant specific users access to specific connections
- **LDAP/AD Integration**: Connect to Active Directory for authentication

## üîó Resources

- [Official Documentation](https://guacamole.apache.org/doc/gug/)
- [Protocol Settings](https://guacamole.apache.org/doc/gug/configuring-guacamole.html)
- [User Management](https://guacamole.apache.org/doc/gug/administration.html)
